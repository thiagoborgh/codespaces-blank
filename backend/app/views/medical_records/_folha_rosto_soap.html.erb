<div class="tab-pane fade" id="soap" role="tabpanel">
  <div class="row">
    <div class="col-md-12">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5>Evolução SOAP</h5>
        <button class="btn btn-primary" onclick="showSoapForm()">Nova Evolução</button>
      </div>
      
      <div id="soapForm" class="soap-form" style="display: none;">
        <div class="row">
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label">Subjetivo (S)</label>
              <textarea class="form-control" rows="3" placeholder="Queixa principal, sintomas relatados pelo paciente..."></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Objetivo (O)</label>
              <textarea class="form-control" rows="3" placeholder="Exame físico, sinais vitais, resultados de exames..."></textarea>
            </div>
          </div>
          <div class="col-md-6">
            <div class="mb-3">
              <label class="form-label">Avaliação (A)</label>
              <textarea class="form-control" rows="3" placeholder="Diagnóstico, impressão clínica..."></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Plano (P)</label>
              <textarea class="form-control" rows="3" placeholder="Tratamento, medicações, seguimento..."></textarea>
            </div>
          </div>
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-success" onclick="saveSoapEntry()">Salvar</button>
          <button class="btn btn-secondary" onclick="hideSoapForm()">Cancelar</button>
        </div>
      </div>
      
      <div class="mt-4">
        <% if @patient.soap_entries.any? %>
          <% @patient.soap_entries.order(created_at: :desc).each do |soap| %>
            <div class="card mb-3">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                  <h6 class="card-title">
                    <%= soap.created_at.strftime('%d/%m/%Y às %H:%M') %>
                  </h6>
                  <small class="text-muted">Dr. <%= soap.doctor_name rescue 'Não informado' %></small>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <strong>Subjetivo:</strong>
                    <p class="text-muted"><%= soap.subjective %></p>
                    <strong>Objetivo:</strong>
                    <p class="text-muted"><%= soap.objective %></p>
                  </div>
                  <div class="col-md-6">
                    <strong>Avaliação:</strong>
                    <p class="text-muted"><%= soap.assessment %></p>
                    <strong>Plano:</strong>
                    <p class="text-muted"><%= soap.plan %></p>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="text-center text-muted">
            <i class="bi bi-file-text" style="font-size: 3rem;"></i>
            <p>Nenhuma evolução SOAP registrada</p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
