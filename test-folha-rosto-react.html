<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Folha Rosto React</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chart-container { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 16px; }
        .chart-line { stroke: #3b82f6; stroke-width: 2; fill: none; }
        .chart-point { fill: #3b82f6; stroke: white; stroke-width: 2; }
        .table-row:hover { background-color: #f1f5f9; }
        .editable-cell { cursor: pointer; padding: 8px; border-radius: 4px; }
        .editable-cell:hover { background-color: #e2e8f0; }
        .editing { background-color: #dbeafe; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Componente de teste da Folha Rosto
        const TestFolhaRosto = () => {
            const [activeSubTab, setActiveSubTab] = React.useState('atendimento');
            const [medicalSubTab, setMedicalSubTab] = React.useState('vitais');
            const [editingCell, setEditingCell] = React.useState(null);

            // Dados mock
            const mockPatient = {
                id: 1,
                name: 'Maria Silva Santos',
                cpf: '12345678901',
                birth_date: '1985-03-15'
            };

            const consultations = [
                {
                    id: 1,
                    date: '18/09/2024 √†s 12:00',
                    ciap2: 'Dores musculares - L18',
                    cid10: 'M79.3 - Dor muscular',
                    interventions: 'Prescri√ß√£o de analg√©sico',
                    age: '21 anos 4 meses',
                    type: 'escuta'
                },
                {
                    id: 2,
                    date: '18/08/2024 √†s 12:00',
                    ciap2: 'Dores musculares - L18',
                    cid10: 'M79.3 - Dor muscular',
                    interventions: 'Fisioterapia recomendada',
                    age: '21 anos 3 meses',
                    type: 'consulta'
                }
            ];

            const measurements = [
                { id: 1, date: '15/09/2024', weight: 70.5, height: 165, bmi: 25.9, cephalicPerimeter: 56, abdominalCircumference: 85 },
                { id: 2, date: '15/08/2024', weight: 71.2, height: 165, bmi: 26.1, cephalicPerimeter: 56, abdominalCircumference: 86 },
                { id: 3, date: '15/07/2024', weight: 72.0, height: 165, bmi: 26.4, cephalicPerimeter: 56, abdominalCircumference: 87 }
            ];

            const vitalSigns = [
                { id: 1, date: '15/09/2024', bloodPressure: '120/80', heartRate: 72, oxygenSaturation: 98, temperature: 36.5 },
                { id: 2, date: '15/08/2024', bloodPressure: '118/78', heartRate: 75, oxygenSaturation: 98, temperature: 36.7 },
                { id: 3, date: '15/07/2024', bloodPressure: '122/82', heartRate: 70, oxygenSaturation: 97, temperature: 36.4 }
            ];

            const glycemia = [
                { id: 1, date: '15/09/2024', value: 95, collectionMoment: 'jejum' },
                { id: 2, date: '10/09/2024', value: 140, collectionMoment: 'pos-prandial' },
                { id: 3, date: '05/09/2024', value: 88, collectionMoment: 'jejum' }
            ];

            // Fun√ß√µes dos gr√°ficos
            const generateAnthropometryChart = () => {
                const data = measurements.slice().reverse();
                const maxWeight = Math.max(...data.map(d => d.weight)) + 5;
                const minWeight = Math.min(...data.map(d => d.weight)) - 5;
                
                const points = data.map((d, i) => {
                    const x = 50 + (i * 150);
                    const y = 50 + ((maxWeight - d.weight) / (maxWeight - minWeight)) * 100;
                    return `${x},${y}`;
                }).join(' ');

                return (
                    <div className="chart-container">
                        <h4 className="font-medium text-gray-900 mb-2">üìè Evolu√ß√£o do Peso</h4>
                        <svg width="300" height="200" className="w-full">
                            <polyline points={points} className="chart-line" />
                            {data.map((d, i) => {
                                const x = 50 + (i * 150);
                                const y = 50 + ((maxWeight - d.weight) / (maxWeight - minWeight)) * 100;
                                return (
                                    <circle key={i} cx={x} cy={y} r="4" className="chart-point" />
                                );
                            })}
                            {data.map((d, i) => {
                                const x = 50 + (i * 150);
                                return (
                                    <text key={i} x={x} y="180" textAnchor="middle" className="text-xs fill-gray-600">
                                        {d.date.split('/')[0]}/{d.date.split('/')[1]}
                                    </text>
                                );
                            })}
                        </svg>
                        <p className="text-sm text-gray-600 mt-2">
                            Varia√ß√£o: {(Math.max(...data.map(d => d.weight)) - Math.min(...data.map(d => d.weight))).toFixed(1)}kg
                        </p>
                    </div>
                );
            };

            const generateVitalSignsChart = () => {
                const data = vitalSigns.slice().reverse();
                
                return (
                    <div className="chart-container">
                        <h4 className="font-medium text-gray-900 mb-2">üíì Sinais Vitais</h4>
                        <svg width="300" height="200" className="w-full">
                            {data.map((d, i) => {
                                const x = 50 + (i * 100);
                                const heartY = 50 + ((100 - d.heartRate) / 100) * 100;
                                const tempY = 150 + ((40 - d.temperature) / 4) * 50;
                                
                                return (
                                    <g key={i}>
                                        <circle cx={x} cy={heartY} r="3" fill="#ef4444" />
                                        <circle cx={x} cy={tempY} r="3" fill="#22c55e" />
                                        <text x={x} y="190" textAnchor="middle" className="text-xs fill-gray-600">
                                            {d.date.split('/')[0]}/{d.date.split('/')[1]}
                                        </text>
                                    </g>
                                );
                            })}
                        </svg>
                        <div className="flex space-x-4 text-sm mt-2">
                            <div className="flex items-center">
                                <div className="w-3 h-3 bg-red-500 rounded-full mr-1"></div>
                                FC (bpm)
                            </div>
                            <div className="flex items-center">
                                <div className="w-3 h-3 bg-green-500 rounded-full mr-1"></div>
                                Temp (¬∞C)
                            </div>
                        </div>
                    </div>
                );
            };

            const generateGlycemiaChart = () => {
                const data = glycemia.slice().reverse();
                const colors = {
                    'jejum': '#3b82f6',
                    'pre-prandial': '#f59e0b',
                    'pos-prandial': '#ef4444',
                    'nao-especificado': '#6b7280'
                };
                
                return (
                    <div className="chart-container">
                        <h4 className="font-medium text-gray-900 mb-2">ü©∏ Glicemia Capilar</h4>
                        <svg width="300" height="200" className="w-full">
                            <line x1="50" y1="100" x2="250" y2="100" stroke="#22c55e" strokeWidth="2" strokeDasharray="5,5" />
                            <text x="255" y="105" className="text-xs fill-green-600">Normal: 70-100</text>
                            
                            {data.map((d, i) => {
                                const x = 50 + (i * 80);
                                const y = 50 + ((200 - d.value) / 200) * 100;
                                
                                return (
                                    <g key={i}>
                                        <circle cx={x} cy={y} r="5" fill={colors[d.collectionMoment]} />
                                        <text x={x} y={y - 10} textAnchor="middle" className="text-xs fill-gray-700">
                                            {d.value}
                                        </text>
                                        <text x={x} y="180" textAnchor="middle" className="text-xs fill-gray-600">
                                            {d.date.split('/')[0]}/{d.date.split('/')[1]}
                                        </text>
                                    </g>
                                );
                            })}
                        </svg>
                        <div className="flex space-x-2 text-xs mt-2">
                            <div className="flex items-center">
                                <div className="w-2 h-2 bg-blue-500 rounded-full mr-1"></div>
                                Jejum
                            </div>
                            <div className="flex items-center">
                                <div className="w-2 h-2 bg-amber-500 rounded-full mr-1"></div>
                                Pr√©-prandial
                            </div>
                            <div className="flex items-center">
                                <div className="w-2 h-2 bg-red-500 rounded-full mr-1"></div>
                                P√≥s-prandial
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className="max-w-6xl mx-auto p-6 bg-gray-50 min-h-screen">
                    <div className="bg-white rounded-lg shadow-sm border border-gray-200">
                        {/* Header */}
                        <div className="px-6 py-4 border-b border-gray-200">
                            <h2 className="text-xl font-semibold text-gray-900">
                                üìã Folha Rosto - {mockPatient.name}
                            </h2>
                            <p className="text-sm text-gray-600">
                                Informa√ß√µes consolidadas do atendimento e medi√ß√µes
                            </p>
                        </div>

                        {/* Tabs */}
                        <div className="border-b border-gray-200">
                            <nav className="flex px-6">
                                <button
                                    onClick={() => setActiveSubTab('atendimento')}
                                    className={`px-4 py-3 text-sm font-medium border-b-2 ${
                                        activeSubTab === 'atendimento'
                                            ? 'border-blue-500 text-blue-600'
                                            : 'border-transparent text-gray-500 hover:text-gray-700'
                                    }`}
                                >
                                    üìä Informa√ß√µes de Atendimento
                                </button>
                                <button
                                    onClick={() => setActiveSubTab('medicoes')}
                                    className={`px-4 py-3 text-sm font-medium border-b-2 ${
                                        activeSubTab === 'medicoes'
                                            ? 'border-blue-500 text-blue-600'
                                            : 'border-transparent text-gray-500 hover:text-gray-700'
                                    }`}
                                >
                                    üìè Medi√ß√µes
                                </button>
                            </nav>
                        </div>

                        {/* Content */}
                        <div className="p-6">
                            {activeSubTab === 'atendimento' && (
                                <div className="space-y-8">
                                    {/* √öltimas Consultas */}
                                    <div>
                                        <h3 className="text-lg font-medium text-gray-900 mb-4 flex items-center">
                                            ü©∫ √öltimas Consultas
                                        </h3>
                                        <div className="overflow-x-auto">
                                            <table className="min-w-full bg-white border border-gray-200 rounded-lg">
                                                <thead className="bg-gray-50">
                                                    <tr>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Data/Hora</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">CIAP 2</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">CID 10</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Interven√ß√µes</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Idade</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tipo</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y divide-gray-200">
                                                    {consultations.map((consultation) => (
                                                        <tr key={consultation.id} className="table-row">
                                                            <td className="px-4 py-3 text-sm text-gray-900">{consultation.date}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{consultation.ciap2}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{consultation.cid10}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{consultation.interventions}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{consultation.age}</td>
                                                            <td className="px-4 py-3">
                                                                <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                                                                    consultation.type === 'escuta' ? 'bg-blue-100 text-blue-800' :
                                                                    consultation.type === 'consulta' ? 'bg-green-100 text-green-800' :
                                                                    'bg-purple-100 text-purple-800'
                                                                }`}>
                                                                    {consultation.type === 'escuta' ? 'üëÇ Escuta' :
                                                                     consultation.type === 'consulta' ? 'ü©∫ Consulta' :
                                                                     'üî¨ Procedimento'}
                                                                </span>
                                                            </td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {activeSubTab === 'medicoes' && (
                                <div className="space-y-8">
                                    {/* Sub-tabs das medi√ß√µes */}
                                    <div className="border-b border-gray-200">
                                        <nav className="flex space-x-8">
                                            <button
                                                onClick={() => setMedicalSubTab('vitais')}
                                                className={`py-2 px-1 border-b-2 font-medium text-sm ${
                                                    medicalSubTab === 'vitais'
                                                        ? 'border-red-500 text-red-600'
                                                        : 'border-transparent text-gray-500 hover:text-gray-700'
                                                }`}
                                            >
                                                üíì Sinais Vitais
                                            </button>
                                            <button
                                                onClick={() => setMedicalSubTab('glicemia')}
                                                className={`py-2 px-1 border-b-2 font-medium text-sm ${
                                                    medicalSubTab === 'glicemia'
                                                        ? 'border-red-500 text-red-600'
                                                        : 'border-transparent text-gray-500 hover:text-gray-700'
                                                }`}
                                            >
                                                ü©∏ Glicemia Capilar
                                            </button>
                                        </nav>
                                    </div>

                                    {/* Gr√°ficos */}
                                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                        {generateAnthropometryChart()}
                                        {medicalSubTab === 'vitais' && generateVitalSignsChart()}
                                        {medicalSubTab === 'glicemia' && generateGlycemiaChart()}
                                    </div>

                                    {/* Tabela de medi√ß√µes */}
                                    <div>
                                        <h3 className="text-lg font-medium text-gray-900 mb-4">
                                            üìä Hist√≥rico de Medi√ß√µes
                                        </h3>
                                        <div className="overflow-x-auto">
                                            <table className="min-w-full bg-white border border-gray-200 rounded-lg">
                                                <thead className="bg-gray-50">
                                                    <tr>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Data</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Peso (kg)</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Altura (cm)</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">IMC</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">P. Cef√°lico</th>
                                                        <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">C. Abdominal</th>
                                                    </tr>
                                                </thead>
                                                <tbody className="divide-y divide-gray-200">
                                                    {measurements.map((measurement) => (
                                                        <tr key={measurement.id} className="table-row">
                                                            <td className="px-4 py-3 text-sm text-gray-900">{measurement.date}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{measurement.weight}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{measurement.height}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{measurement.bmi}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{measurement.cephalicPerimeter}</td>
                                                            <td className="px-4 py-3 text-sm text-gray-900">{measurement.abdominalCircumference}</td>
                                                        </tr>
                                                    ))}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Renderizar o componente
        ReactDOM.render(<TestFolhaRosto />, document.getElementById('root'));
    </script>
</body>
</html>
